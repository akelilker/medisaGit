# Force HTTPS and www redirect
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Favicon.ico -> SVG favicon yönlendirmesi
    RewriteRule ^favicon\.ico$ icon/favicon.svg [L,T=image/svg+xml]

    # Force HTTPS
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # Force www
    RewriteCond %{HTTP_HOST} !^www\. [NC]
    RewriteRule ^(.*)$ https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

# CORS Headers - HERYERE uygula
<IfModule mod_headers.c>
    # Her durumda CORS başlıklarını ekle (redirect sonrasında bile)
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS, HEAD"
    Header always set Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept"
    Header always set Access-Control-Allow-Credentials "true"
    Header always set Access-Control-Max-Age "3600"
    
    # Manifest için özel Content-Type
    <FilesMatch "manifest\.json$">
        Header always set Content-Type "application/manifest+json; charset=utf-8"
        Header always set Access-Control-Allow-Origin "*"
        Header always set Cache-Control "public, max-age=0"
    </FilesMatch>
    
    # Service Worker
    <FilesMatch "sw\.js$">
        Header always set Content-Type "application/javascript; charset=utf-8"
        Header always set Access-Control-Allow-Origin "*"
        Header always set Service-Worker-Allowed "/"
        Header always set Cache-Control "no-cache"
    </FilesMatch>
    
    # JSON files
    <FilesMatch "\.json$">
        Header always set Content-Type "application/json; charset=utf-8"
        Header always set Access-Control-Allow-Origin "*"
    </FilesMatch>
</IfModule>

# UTF-8 encoding
AddDefaultCharset UTF-8

# MIME types
AddType application/manifest+json .json .webmanifest
AddType application/javascript .js

# OPTIONS request için hızlı yanıt
<IfModule mod_rewrite.c>
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^(.*)$ $1 [R=200,L]
</IfModule>
